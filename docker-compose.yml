version: '3'

services:
     web:
       image: nginx:alpine
       restart: always
       ports:
           - "80:80"
           - "443:443"
       volumes:
           - ./public_html:/public_html
           - ./conf.d:/etc/nginx/conf.d
           - /etc/localtime:/etc/localtime
           - ./dhparam:/etc/nginx/dhparam
           - ./certbot/conf/:/etc/nginx/ssl/
           - ./certbot/data:/usr/share/nginx/html/letsencrypt           
       networks:
           - nginxphp
     php:
       image: php:7.1.11-fpm-alpine
       volumes:
           - ./public_html:/public_html
       expose:
           - 9000
       networks:
           - nginxphp
     certbot:
       image: certbot/certbot:latest
       command: certonly --webroot --webroot-path=/usr/share/nginx/html/letsencrypt --email admin@cinamon.digital --agree-tos --no-eff-email -d api.esllist.com
       volumes:
          - ./certbot/conf/:/etc/letsencrypt
          - ./certbot/logs/:/var/log/letsencrypt
          - ./certbot/data:/usr/share/nginx/html/letsencrypt         
networks:
     nginxphp: